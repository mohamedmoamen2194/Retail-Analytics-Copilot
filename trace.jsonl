{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": true}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-12-01' AND '1997-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "SELECT c.CompanyName AS customer,\n                       SUM(od.UnitPrice * 0.3 * od.Quantity * (1 - od.Discount)) AS margin\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Customers c ON c.CustomerID = o.CustomerID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30'\n                GROUP BY c.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": true}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": true}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-12-01' AND '1997-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "SELECT c.CompanyName AS customer,\n                       SUM(od.UnitPrice * 0.3 * od.Quantity * (1 - od.Discount)) AS margin\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Customers c ON c.CustomerID = o.CustomerID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30'\n                GROUP BY c.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": true}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": true}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-12-01' AND '1997-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "SELECT c.CompanyName AS customer,\n                       SUM(od.UnitPrice * 0.3 * od.Quantity * (1 - od.Discount)) AS margin\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Customers c ON c.CustomerID = o.CustomerID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30'\n                GROUP BY c.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": true}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": true}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-12-01' AND '1997-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "SELECT c.CompanyName AS customer,\n                       SUM(od.UnitPrice * 0.3 * od.Quantity * (1 - od.Discount)) AS margin\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Customers c ON c.CustomerID = o.CustomerID\n                WHERE DATE(o.OrderDate) BETWEEN '1997-06-01' AND '1997-06-30'\n                GROUP BY c.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": true}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-12-01' AND '2013-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "SELECT c.CompanyName AS customer,\n                       SUM(od.UnitPrice * 0.3 * od.Quantity * (1 - od.Discount)) AS margin\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Customers c ON c.CustomerID = o.CustomerID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-12-01' AND '2013-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "sql", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-12-01' AND '2013-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "sql", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-12-01' AND '2013-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "sql", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-12-01' AND '2013-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "sql", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-12-01' AND '2013-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "sql", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "SELECT c.CompanyName AS customer,\n                       SUM(od.UnitPrice * 0.3 * od.Quantity * (1 - od.Discount)) AS margin\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Customers c ON c.CustomerID = o.CustomerID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "rag_policy_beverages_return_days", "question": "According to the product policy, what is the return window (days) for unopened Beverages? Return an integer.", "route": "rag", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_top_category_qty_summer_1997", "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold? Return {category:str, quantity:int}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages"}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_aov_winter_1997", "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'? Return a float rounded to 2 decimals.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Confections", "kpi": "aov"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-12-01' AND '2013-12-31';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "sql_top3_products_by_revenue_alltime", "question": "Top 3 products by total revenue all-time. Revenue uses Order Details: SUM(UnitPrice*Quantity*(1-Discount)). Return list[{product:str, revenue:float}].", "route": "sql", "constraints": {"date_range": {"start": "1997-12-01", "end": "1997-12-31"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_revenue_beverages_summer_1997", "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates. Return a float rounded to 2 decimals.", "route": "sql", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "revenue"}, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30';", "sql_success": true, "repairs": 0, "needs_repair": false}
{"item_id": "hybrid_best_customer_margin_1997", "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available. Return {customer:str, margin:float}.", "route": "hybrid", "constraints": {"date_range": {"start": "1997-06-01", "end": "1997-06-30"}, "category": "Beverages", "kpi": "gross_margin"}, "sql": "SELECT c.CompanyName AS customer,\n                       SUM(od.UnitPrice * 0.3 * od.Quantity * (1 - od.Discount)) AS margin\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Customers c ON c.CustomerID = o.CustomerID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1;", "sql_success": true, "repairs": 0, "needs_repair": false}
