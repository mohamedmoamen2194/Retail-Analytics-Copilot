{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "", "confidence": 0.85, "explanation": "Matched return window from policy docs.", "citations": ["product_policy.md::chunk_0", "marketing_calendar.md::chunk_1", "catalog.md::chunk_0", "kpi_definitions.md::chunk_0", "marketing_calendar.md::chunk_0", "kpi_definitions.md::chunk_1", "marketing_calendar.md::chunk_2"]}
{"id": "hybrid_top_category_qty_summer_1997", "final_answer": {"category": "Confections", "quantity": 17661}, "sql": "SELECT c.CategoryName AS category,\n                       SUM(od.Quantity) AS quantity\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CategoryID\n                ORDER BY quantity DESC\n                LIMIT 1;", "confidence": 0.9, "explanation": "Derived structured answer from SQL results.", "citations": ["Categories c ON c", "Order Details", "Orders o ON o", "Products p ON p", "marketing_calendar.md::chunk_0", "kpi_definitions.md::chunk_1", "marketing_calendar.md::chunk_1", "kpi_definitions.md::chunk_0", "marketing_calendar.md::chunk_2", "catalog.md::chunk_0", "product_policy.md::chunk_0"]}
{"id": "hybrid_aov_winter_1997", "final_answer": 32329.37, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n                       / COUNT(DISTINCT o.OrderID) AS aov\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-12-01' AND '2013-12-31';", "confidence": 0.9, "explanation": "Computed metric via SQL over Orders/Order Details.", "citations": ["Order Details", "Orders o ON o", "kpi_definitions.md::chunk_0", "marketing_calendar.md::chunk_2", "marketing_calendar.md::chunk_1", "marketing_calendar.md::chunk_0", "kpi_definitions.md::chunk_1", "catalog.md::chunk_0", "product_policy.md::chunk_0"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": [{"product": "C\u00f4te de Blaye", "revenue": 53265895.23}, {"product": "Th\u00fcringer Rostbratwurst", "revenue": 24623469.23}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT p.ProductName AS product,\n                       SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Products p ON p.ProductID = od.ProductID\n                GROUP BY p.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3;", "confidence": 0.9, "explanation": "Ranked entities using revenue aggregation.", "citations": ["Order Details", "Products p ON p", "kpi_definitions.md::chunk_0", "kpi_definitions.md::chunk_1", "catalog.md::chunk_0", "marketing_calendar.md::chunk_2", "marketing_calendar.md::chunk_0", "marketing_calendar.md::chunk_1", "product_policy.md::chunk_0"]}
{"id": "hybrid_revenue_beverages_summer_1997", "final_answer": 605206.0, "sql": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Products p ON p.ProductID = od.ProductID\n                JOIN Categories c ON c.CategoryID = p.CategoryID\n                WHERE c.CategoryName = 'Beverages' AND DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30';", "confidence": 0.9, "explanation": "Computed metric via SQL over Orders/Order Details.", "citations": ["Categories c ON c", "Order Details", "Orders o ON o", "Products p ON p", "marketing_calendar.md::chunk_1", "marketing_calendar.md::chunk_2", "kpi_definitions.md::chunk_1", "marketing_calendar.md::chunk_0", "catalog.md::chunk_0", "product_policy.md::chunk_0", "kpi_definitions.md::chunk_0"]}
{"id": "hybrid_best_customer_margin_1997", "final_answer": {"customer": "Great Lakes Food Market", "margin": 56554.53}, "sql": "SELECT c.CompanyName AS customer,\n                       SUM(od.UnitPrice * 0.3 * od.Quantity * (1 - od.Discount)) AS margin\n                FROM \"Order Details\" od\n                JOIN Orders o ON o.OrderID = od.OrderID\n                JOIN Customers c ON c.CustomerID = o.CustomerID\n                WHERE DATE(o.OrderDate) BETWEEN '2013-06-01' AND '2013-06-30'\n                GROUP BY c.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1;", "confidence": 0.9, "explanation": "Derived structured answer from SQL results.", "citations": ["Customers c ON c", "Order Details", "Orders o ON o", "kpi_definitions.md::chunk_1", "marketing_calendar.md::chunk_1", "marketing_calendar.md::chunk_2", "marketing_calendar.md::chunk_0", "kpi_definitions.md::chunk_0", "catalog.md::chunk_0", "product_policy.md::chunk_0"]}
